<!DOCTYPE html>
<html>
<head>
<style>
.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */
.result { color: #F03434 }
.count { text-align: right }
.bug_counts { font-family: monospace; }
table { border-collapse: collapse; border-spacing: 0px; margin-bottom: 10px; }
table, th, td { padding: 5px; border: 1px solid black; }
</style>
</head>
<body>
<div class="bug_counts">
<table style="display: inline-table;">
<tr><th colspan="2">flawfinder</th></tr><tr><td>(buffer) char</td><td class="count">4</td></tr><tr><td>(buffer) memcpy</td><td class="count">3</td></tr><tr><td>(buffer) strncpy</td><td class="count">1</td></tr></table>
<table style="display: inline-table;">
<tr><th colspan="2">cppcheck</th></tr><tr><td>negativeIndex</td><td class="count">1</td></tr><tr><td>arrayIndexOutOfBounds</td><td class="count">2</td></tr></table>
<table style="display: inline-table;">
<tr><th colspan="2">scan-build</th></tr><tr><td>core.NullDereference</td><td class="count">1</td></tr><tr><td>core.UndefinedBinaryOperatorResult</td><td class="count">2</td></tr><tr><td>deadcode.DeadStores</td><td class="count">1</td></tr></table>
<table style="display: inline-table;">
<tr><th colspan="2">infer</th></tr><tr><td>Null Dereference</td><td class="count">3</td></tr><tr><td>Buffer Overrun L3</td><td class="count">1</td></tr><tr><td>Dead Store</td><td class="count">2</td></tr><tr><td>Buffer Overrun L1</td><td class="count">4</td></tr></table>
</div>
<div class="highlight"><pre>
  1 <span class="cp">#include</span> <span class="cpf">&quot;HeaderFile.h&quot;</span><span class="cp"></span>
  2 
  3 <span class="cm">/********Software Analysis - FY2013*************/</span>
  4 <span class="cm">/*</span>
  5 <span class="cm">* File Name: buffer_underrun_dynamic.c</span>
  6 <span class="cm">* Defect Classification</span>
  7 <span class="cm">* ---------------------</span>
  8 <span class="cm">* Defect Type: Dynamic memory defects</span>
  9 <span class="cm">* Defect Sub-type: Dynamic buffer underrun</span>
 10 <span class="cm">*</span>
 11 <span class="cm">*  Created on: Sep 27, 2012</span>
 12 <span class="cm">*      Author: caesaru01</span>
 13 <span class="cm">*/</span>
 14 
 15 <span class="cm">/*</span>
 16 <span class="cm"> * Dynamic buffer underrun</span>
 17 <span class="cm"> * When using a pointer to char</span>
 18 <span class="cm"> */</span>
 19 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_001</span> <span class="p">()</span>
 20 <span class="p">{</span>
 21 	<span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
 22 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
 23 	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;print bufferundr&quot;</span><span class="p">);</span>
 24 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
 25 	<span class="p">{</span>
 26 	<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
 27 	    <span class="p">{</span>
 28 		<span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>  <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
 29 	    <span class="p">}</span>
 30 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
 31 	<span class="p">}</span>
 32 <span class="p">}</span>
 33 
 34 <span class="cm">/*</span>
 35 <span class="cm"> * Dynamic buffer underrun</span>
 36 <span class="cm"> *When using a pointer to short</span>
 37 <span class="cm"> */</span>
 38 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_002</span> <span class="p">()</span>
 39 <span class="p">{</span>
 40 	<span class="n">printf</span><span class="p">(</span><span class="s">&quot;underrun2&quot;</span><span class="p">);</span>
 41 	<span class="kt">short</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">short</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">short</span><span class="p">));</span>
 42 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
 43 	<span class="p">{</span>
 44 	    <span class="o">*</span><span class="p">(</span><span class="n">buf</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
 45 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
 46 	<span class="p">}</span>
 47 <span class="p">}</span>
 48 
 49 <span class="cm">/*</span>
 50 <span class="cm"> * Dynamic buffer underrun</span>
 51 <span class="cm"> *When using a pointer to int</span>
 52 <span class="cm"> */</span>
 53 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_003</span> <span class="p">()</span>
 54 <span class="p">{</span>
 55 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
 56 	<span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>
 57 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
 58 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
 59 	<span class="p">{</span>
 60 		<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
 61 		<span class="p">{</span>
 62 			<span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
 63 		<span class="p">}</span>
 64 	<span class="n">ret</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
 65 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
 66 		<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="n">ret</span><span class="p">);</span>
 67 	<span class="p">}</span>
 68 <span class="p">}</span>
 69 
 70 <span class="cm">/*</span>
 71 <span class="cm"> * Dynamic buffer underrun</span>
 72 <span class="cm"> *When using a pointer to int</span>
 73 <span class="cm"> */</span>
 74 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_004</span> <span class="p">()</span>
 75 <span class="p">{</span>
 76 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
 77 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
 78 	<span class="p">{</span>
 79 	    <span class="o">*</span><span class="p">(</span><span class="n">buf</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
 80 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
 81 	<span class="p">}</span>
 82 <span class="p">}</span>
 83 
 84 <span class="cm">/*</span>
 85 <span class="cm"> * Dynamic buffer underrun</span>
 86 <span class="cm"> * When using a pointer to long</span>
 87 <span class="cm"> */</span>
 88 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_005</span> <span class="p">()</span>
 89 <span class="p">{</span>
 90 	<span class="kt">long</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">long</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">long</span><span class="p">));</span>
 91 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
 92 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
 93 	<span class="p">{</span>
 94 	    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
 95 		<span class="p">{</span>
 96 	        <span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
 97 		<span class="p">}</span>
 98 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
 99 	<span class="p">}</span>
100 <span class="p">}</span>
101 
102 <span class="cm">/*</span>
103 <span class="cm"> * Dynamic buffer underrun</span>
104 <span class="cm"> * When using a pointer to float</span>
105 <span class="cm"> */</span>
106 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_006</span> <span class="p">()</span>
107 <span class="p">{</span>
108 	<span class="kt">float</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">float</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">));</span>
109 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
110 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
111 	<span class="p">{</span>
112 		<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
113 		<span class="p">{</span>
114 			<span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
115 		<span class="p">}</span>
116 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
117 	<span class="p">}</span>
118 <span class="p">}</span>
119 
120 <span class="cm">/*</span>
121 <span class="cm"> * Dynamic buffer underrun</span>
122 <span class="cm"> * When using a pointer to double</span>
123 <span class="cm"> */</span>
124 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_007</span> <span class="p">()</span>
125 <span class="p">{</span>
126 	<span class="kt">double</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">));</span>
127 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
128 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
129 	<span class="p">{</span>
130 		<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
131 		<span class="p">{</span>
132 			<span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
133 		<span class="p">}</span>
134 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
135 	<span class="p">}</span>
136 <span class="p">}</span>
137 
138 <span class="cm">/*</span>
139 <span class="cm"> * Dynamic buffer underrun</span>
140 <span class="cm"> * When using double pointers to the type int</span>
141 <span class="cm"> */</span>
142 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_008</span> <span class="p">()</span>
143 <span class="p">{</span>
144 	<span class="kt">int</span> <span class="o">**</span><span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">**</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">));</span>
145 	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
146 
147 	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
148 		<span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
<span class="result">    > infer: (HIGH Null Dereference) pointer `buf` last assigned on line 144 could be null and is dereferenced at line 148, column 3.</span>
149 
150 	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
151 	<span class="p">{</span>
152 		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
153 		<span class="p">{</span>
154 			<span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">buf</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="n">i</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
155 		<span class="p">}</span>
156 		<span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
157 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
158 	<span class="p">}</span>
159 	<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
160 <span class="p">}</span>
161 
162 <span class="cm">/*</span>
163 <span class="cm"> * Dynamic buffer underrun</span>
164 <span class="cm"> * When using double pointers to the type int</span>
165 <span class="cm"> */</span>
166 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_009</span> <span class="p">()</span>
167 <span class="p">{</span>
168 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf1</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
169 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf2</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
170 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf3</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
171 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf4</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
172 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf5</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
173 	<span class="kt">int</span> <span class="o">**</span><span class="n">pbuf</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="o">&amp;</span><span class="n">buf1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf3</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf4</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf5</span><span class="p">};</span>
174 	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
175 	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
176 	<span class="p">{</span>
177 		<span class="o">*</span><span class="p">((</span><span class="o">*</span><span class="n">pbuf</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
<span class="result">    > cppcheck: (error negativeIndex) Array index -3 is out of bounds.</span>
<span class="result">    > scan-build: (Logic error core.NullDereference) Dereference of undefined pointer value</span>
<span class="result">    > infer: (HIGH Buffer Overrun L3) Offset: [-3, 1] Size: [5, 5].</span>
178 	<span class="p">}</span>
179 	<span class="n">free</span><span class="p">(</span><span class="n">buf1</span><span class="p">);</span>
180 	<span class="n">free</span><span class="p">(</span><span class="n">buf2</span><span class="p">);</span>
181 	<span class="n">free</span><span class="p">(</span><span class="n">buf3</span><span class="p">);</span>
182 	<span class="n">free</span><span class="p">(</span><span class="n">buf4</span><span class="p">);</span>
183 	<span class="n">free</span><span class="p">(</span><span class="n">buf5</span><span class="p">);</span>
184 <span class="p">}</span>
185 
186 <span class="cm">/*</span>
187 <span class="cm"> * Dynamic buffer underrun</span>
188 <span class="cm"> * When using pointers to the structure</span>
189 <span class="cm"> */</span>
190 <span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
191 	<span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
192 	<span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
193 	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
194 <span class="p">}</span> <span class="n">dynamic_buffer_underrun_010_s_001</span><span class="p">;</span>
195 
196 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_010</span> <span class="p">()</span>
197 <span class="p">{</span>
198 	<span class="n">dynamic_buffer_underrun_010_s_001</span><span class="o">*</span> <span class="n">sbuf</span><span class="o">=</span> <span class="p">(</span><span class="n">dynamic_buffer_underrun_010_s_001</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_010_s_001</span><span class="p">))</span> <span class="p">;</span>
199 	<span class="k">if</span><span class="p">(</span><span class="n">sbuf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
200 	<span class="p">{</span>
201 	    <span class="n">sbuf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
202 	    <span class="n">free</span><span class="p">(</span><span class="n">sbuf</span><span class="p">);</span>
203 	<span class="p">}</span>
204 <span class="p">}</span>
205 
206 <span class="cm">/*</span>
207 <span class="cm"> * Dynamic buffer underrun</span>
208 <span class="cm"> * When using pointers to the structure with an array as a member of the structure</span>
209 <span class="cm"> */</span>
210 <span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
211 	<span class="kt">int</span> <span class="n">a</span><span class="p">;</span>
212 	<span class="kt">int</span> <span class="n">b</span><span class="p">;</span>
213 	<span class="kt">int</span> <span class="n">buf</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
214 <span class="p">}</span> <span class="n">dynamic_buffer_underrun_011_s_001</span><span class="p">;</span>
215 
216 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_011</span> <span class="p">()</span>
217 <span class="p">{</span>
218 	<span class="n">dynamic_buffer_underrun_011_s_001</span><span class="o">*</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_011_s_001</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_011_s_001</span><span class="p">))</span> <span class="p">;</span>
219 	<span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
220 	<span class="p">{</span>
221 		<span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">buf</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
222 		<span class="n">free</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
223 	<span class="p">}</span>
224 <span class="p">}</span>
225 
226 <span class="cm">/*</span>
227 <span class="cm"> * Dynamic buffer underrun</span>
228 <span class="cm"> * When using a variable to access the array of pointers</span>
229 <span class="cm"> */</span>
230 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_012</span> <span class="p">()</span>
231 <span class="p">{</span>
232 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
233 	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
234 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
235 	<span class="p">{</span>
236 	    <span class="o">*</span><span class="p">(</span><span class="n">buf</span><span class="o">-</span><span class="n">index</span><span class="p">)</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
237 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
238 	<span class="p">}</span>
239 <span class="p">}</span>
240 <span class="cm">/*</span>
241 <span class="cm"> * Dynamic buffer underrun</span>
242 <span class="cm"> * When using a variable which changes on every iteration to access the array of pointers</span>
243 <span class="cm"> */</span>
244 <span class="kt">void</span>  <span class="nf">dynamic_buffer_underrun_013</span><span class="p">()</span>
245 <span class="p">{</span>
246 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
247 	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="result">    > infer: (HIGH Dead Store) The value written to &index is never used.</span>
248 	<span class="n">index</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
249 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
250     <span class="p">{</span>
251 
252 	    <span class="n">buf</span><span class="p">[</span><span class="o">-</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
253 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
254 	<span class="p">}</span>
255 <span class="p">}</span>
256 
257 <span class="cm">/*</span>
258 <span class="cm"> * Dynamic buffer underrun</span>
259 <span class="cm"> * When performing arithmetic operations on the index variable causing it to go out of bounds.</span>
260 <span class="cm"> */</span>
261 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_014</span> <span class="p">()</span>
262 <span class="p">{</span>
263 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
264 	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
265 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
266 	<span class="p">{</span>
267     	<span class="o">*</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
268 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
269 	<span class="p">}</span>
270 <span class="p">}</span>
271 
272 <span class="cm">/*</span>
273 <span class="cm"> * Dynamic buffer underrun</span>
274 <span class="cm"> * When performing arithmetic operations on the index variable causing it to go out of bounds.</span>
275 <span class="cm"> */</span>
276 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_015</span> <span class="p">()</span>
277 <span class="p">{</span>
278 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
279 	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
280 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
281 	<span class="p">{</span>
282 	    <span class="n">buf</span><span class="p">[(</span><span class="n">index</span> <span class="o">*</span> <span class="n">index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
283 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
284     <span class="p">}</span>
285 <span class="p">}</span>
286 
287 <span class="cm">/*</span>
288 <span class="cm"> * Dynamic buffer underrun</span>
289 <span class="cm"> * When using a return value from a function to access memory</span>
290 <span class="cm"> */</span>
291 
292 <span class="kt">int</span> <span class="nf">dynamic_buffer_underrun_016_func_001</span> <span class="p">()</span>
293 <span class="p">{</span>
294 	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
295 <span class="p">}</span>
296 
297 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_016</span> <span class="p">()</span>
298 <span class="p">{</span>
299 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
300 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
301 	<span class="p">{</span>
302 	    <span class="n">buf</span><span class="p">[</span><span class="n">dynamic_buffer_underrun_016_func_001</span> <span class="p">()]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
303 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
304 	<span class="p">}</span>
305 <span class="p">}</span>
306 
307 <span class="cm">/*</span>
308 <span class="cm"> * Dynamic buffer underrun</span>
309 <span class="cm"> * underrun in the function called</span>
310 <span class="cm"> */</span>
311 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_017_func_001</span> <span class="p">(</span><span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
312 <span class="p">{</span>
313 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
314 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
315 	<span class="p">{</span>
316 	    <span class="o">*</span><span class="p">(</span><span class="n">buf</span> <span class="o">-</span><span class="n">index</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
317 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
318 	<span class="p">}</span>
319 <span class="p">}</span>
320 
321 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_017</span> <span class="p">()</span>
322 <span class="p">{</span>
323 	<span class="n">dynamic_buffer_underrun_017_func_001</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
324 <span class="p">}</span>
325 
326 <span class="cm">/*</span>
327 <span class="cm"> * Dynamic buffer underrun</span>
328 <span class="cm"> * underrun in when using member of some other array as the index</span>
329 <span class="cm"> */</span>
330 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_018</span> <span class="p">()</span>
331 <span class="p">{</span>
332 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
333 	<span class="kt">int</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">};</span>
334 	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
335 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
336 	<span class="p">{</span>
337 	    <span class="o">*</span><span class="p">(</span><span class="n">buf</span><span class="o">-</span><span class="n">indexes</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
338 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
339 	<span class="p">}</span>
340 <span class="p">}</span>
341 
342 <span class="cm">/*</span>
343 <span class="cm"> * Dynamic buffer underrun</span>
344 <span class="cm"> * underrun when using a variable assigned by some other variable</span>
345 <span class="cm"> */</span>
346 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_019</span> <span class="p">()</span>
347 <span class="p">{</span>
348 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
349 	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">;</span>
350 	<span class="kt">int</span> <span class="n">index1</span><span class="p">;</span>
351 	<span class="n">index1</span> <span class="o">=</span> <span class="n">index</span><span class="p">;</span>
352 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
353 	<span class="p">{</span>
354 	    <span class="n">buf</span><span class="p">[</span><span class="n">index1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
355 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
356 	<span class="p">}</span>
357 <span class="p">}</span>
358 
359 <span class="cm">/*</span>
360 <span class="cm"> * Dynamic buffer underrun</span>
361 <span class="cm"> * underrun when using 2 aliases</span>
362 <span class="cm"> */</span>
363 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_020</span> <span class="p">()</span>
364 <span class="p">{</span>
365 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
366 	<span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span><span class="p">;</span>
367 	<span class="kt">int</span> <span class="n">index1</span><span class="p">;</span>
368 	<span class="kt">int</span> <span class="n">index2</span><span class="p">;</span>
369 	<span class="n">index1</span> <span class="o">=</span> <span class="n">index</span><span class="p">;</span>
370 	<span class="n">index2</span> <span class="o">=</span> <span class="n">index1</span><span class="p">;</span>
371 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
372 	<span class="p">{</span>
373 	    <span class="n">buf</span><span class="p">[</span><span class="n">index2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
374 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
375 	<span class="p">}</span>
376 <span class="p">}</span>
377 
378 <span class="cm">/*</span>
379 <span class="cm"> * Dynamic buffer underrun</span>
380 <span class="cm"> * underrun when using 2 pointer aliases</span>
381 <span class="cm"> */</span>
382 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_021</span> <span class="p">()</span>
383 <span class="p">{</span>
384 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
385 	<span class="kt">int</span> <span class="o">*</span><span class="n">p1</span><span class="p">;</span>
386 	<span class="kt">int</span> <span class="o">*</span><span class="n">p2</span><span class="p">;</span>
387 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
388 	<span class="p">{</span>
389 		<span class="n">p1</span> <span class="o">=</span> <span class="n">buf</span><span class="p">;</span>
390 		<span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span><span class="p">;</span>
391 		<span class="o">*</span><span class="p">(</span><span class="n">p2</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
392 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
393 	<span class="p">}</span>
394 <span class="p">}</span>
395 
396 <span class="cm">/*</span>
397 <span class="cm"> * Dynamic buffer underrun</span>
398 <span class="cm"> * underrun when using 1 single pointer alias</span>
399 <span class="cm"> */</span>
400 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_022</span> <span class="p">()</span>
401 <span class="p">{</span>
402 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
403 	<span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
404 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
405 	<span class="p">{</span>
406 	    <span class="n">p</span> <span class="o">=</span> <span class="n">buf</span><span class="p">;</span>
407 	    <span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
408 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
409 	<span class="p">}</span>
410 <span class="p">}</span>
411 
412 <span class="cm">/*</span>
413 <span class="cm"> * Dynamic buffer underrun</span>
414 <span class="cm"> * underrun IN A FOR LOOP</span>
415 <span class="cm"> */</span>
416 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_023</span> <span class="p">()</span>
417 <span class="p">{</span>
418 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
419 	<span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
420 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
421 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
422 	<span class="p">{</span>
423 	    <span class="n">p</span> <span class="o">=</span> <span class="n">buf</span><span class="p">;</span>
424 	    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
425 	    <span class="p">{</span>
426 	    	<span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;1&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
427 	    <span class="p">}</span>
428 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
429 	<span class="p">}</span>
430 <span class="p">}</span>
431 
432 <span class="cm">/*</span>
433 <span class="cm"> * Dynamic buffer underrun</span>
434 <span class="cm"> * underrun when passing the base pointer to a function</span>
435 <span class="cm"> */</span>
436 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_024_func_001</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="p">)</span>
437 <span class="p">{</span>
438 	<span class="o">*</span><span class="p">(</span><span class="n">buf</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
439 <span class="p">}</span>
440 
441 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_024</span> <span class="p">()</span>
442 <span class="p">{</span>
443 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
444 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
445 	<span class="p">{</span>
446 	    <span class="n">dynamic_buffer_underrun_024_func_001</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
447 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
448 	<span class="p">}</span>
449 <span class="p">}</span>
450 
451 
452 <span class="cm">/*</span>
453 <span class="cm"> * Dynamic buffer underrun</span>
454 <span class="cm"> * underrun when using a char pointer</span>
455 <span class="cm"> */</span>
456 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_025</span> <span class="p">()</span>
457 <span class="p">{</span>
458 	<span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
459 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
460 
461 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
462 	<span class="p">{</span>
463 	    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
464 	    <span class="p">{</span>
465 	    	<span class="n">buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;1&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
466 	    <span class="p">}</span>
467 	    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
468 	<span class="p">}</span>
469 <span class="p">}</span>
470 
471 
472 <span class="cm">/*</span>
473 <span class="cm"> * Dynamic buffer underrun</span>
474 <span class="cm"> * underrun when using casting to pointers of larger datatypes (For eg Cast a char to int)</span>
475 <span class="cm"> */</span>
476 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_026</span> <span class="p">()</span>
477 <span class="p">{</span>
478 	<span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
479 	<span class="kt">int</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
480 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
481 	<span class="p">{</span>
482 	     <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
483 	     <span class="o">*</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
484 	     <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
485 	<span class="p">}</span>
486 <span class="p">}</span>
487 
488 <span class="cm">/*</span>
489 <span class="cm"> * Dynamic buffer underrun</span>
490 <span class="cm"> * underrun when using casting to pointers of smaller datatypes (For eg Cast a int to char)</span>
491 <span class="cm"> */</span>
492 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_027</span> <span class="p">()</span>
493 <span class="p">{</span>
494 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
495 	<span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
496 	<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
497 	<span class="p">{</span>
498 		<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
499 		<span class="o">*</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
500 		<span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
501 	<span class="p">}</span>
502 <span class="p">}</span>
503 
504 <span class="cm">/*</span>
505 <span class="cm"> * Dynamic buffer underrun</span>
506 <span class="cm"> * underrun when using values in a different array allocated dynamically</span>
507 <span class="cm"> */</span>
508 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_028</span> <span class="p">()</span>
509 <span class="p">{</span>
510 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf1</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
511 	<span class="kt">int</span> <span class="o">*</span><span class="n">buf2</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
512 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
513 
514 	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
515 	<span class="p">{</span>
516 		<span class="o">*</span><span class="p">(</span><span class="n">buf1</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
517 	<span class="p">}</span>
518 	<span class="o">*</span><span class="p">(</span><span class="n">buf2</span><span class="o">-*</span><span class="p">(</span><span class="n">buf1</span><span class="o">+</span><span class="mi">4</span><span class="p">))</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
519 	<span class="n">free</span><span class="p">(</span><span class="n">buf1</span><span class="p">);</span>
520 	<span class="n">free</span><span class="p">(</span><span class="n">buf2</span><span class="p">);</span>
521 <span class="p">}</span>
522 
523 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_029</span><span class="p">()</span>
524 <span class="p">{</span>
525 
526 	<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
527 	<span class="p">{</span>
528 		<span class="kt">char</span><span class="o">*</span> <span class="n">buf</span><span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
529 		<span class="k">if</span><span class="p">(</span><span class="n">buf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
530 		<span class="p">{</span>
531 		    <span class="n">buf</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
<span class="result">    > cppcheck: (error arrayIndexOutOfBounds) Array 'buf[1]' accessed at index -1, which is out of bounds.</span>
<span class="result">    > infer: (HIGH Buffer Overrun L1) Offset: [-1, -1] Size: [1, 1].</span>
532 		    <span class="n">free</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
533 		<span class="p">}</span>
534 	    <span class="k">break</span><span class="p">;</span>
535 	<span class="p">}</span>
536 <span class="p">}</span>
537 
538 
539 <span class="cm">/* Types of defects: heap underrun(dynamic buffer underrun)</span>
540 <span class="cm">* Complexity: ---- Write outside the allocated buffer in a 2D array</span>
541 <span class="cm">*/</span>
542 
543 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_030</span><span class="p">()</span>
544 <span class="p">{</span>
545 	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
546 	<span class="kt">char</span> <span class="o">**</span> <span class="n">doubleptr</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">**</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">));</span>
547 
548 	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
549 	<span class="p">{</span>
550 		<span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">calloc</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
<span class="result">    > infer: (HIGH Null Dereference) pointer `doubleptr` last assigned on line 546 could be null and is dereferenced at line 550, column 3.</span>
551 	<span class="p">}</span>
552 
553 
554 	<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
555 	<span class="p">{</span>
556 		<span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">--</span><span class="p">)</span>
557 		<span class="p">{</span>
558 		  <span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
559 		<span class="p">}</span>
560 		<span class="n">free</span><span class="p">(</span><span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
561 	<span class="p">}</span>
562 	<span class="n">free</span><span class="p">(</span><span class="n">doubleptr</span><span class="p">);</span>
563 <span class="p">}</span>
564 
565 <span class="cm">/* Types of defects: heap underrun(dynamic buffer underrun)</span>
566 <span class="cm">* Complexity: ---- underrun while using memcpy function</span>
567 <span class="cm">*/</span>
568 
569 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_031</span><span class="p">()</span>
570 <span class="p">{</span>
571 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
572 	<span class="kt">char</span><span class="o">*</span> <span class="n">ptr1</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
573 	<span class="kt">char</span> <span class="n">a</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="o">*</span><span class="n">ptr2</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
<span class="result">    > flawfinder: ([2] (buffer) char) Statically-sized arrays can be improperly restricted, leading to potential overflows or other issues (CWE-119!/CWE-120).  Perform bounds checking, use functions that limit length, or ensure that the size is larger than the maximum possible length.</span>
574 	<span class="k">if</span><span class="p">(</span><span class="n">ptr1</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
575 	<span class="p">{</span>
576 	    <span class="n">ptr1</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
577 	    <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
578 	    <span class="p">{</span>
579 	        <span class="n">ptr1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="p">;</span>
580 	    <span class="p">}</span>
581 	    <span class="n">memcpy</span><span class="p">(</span><span class="n">ptr2</span><span class="p">,</span><span class="n">ptr1</span><span class="p">,</span><span class="mi">12</span><span class="p">);</span>
<span class="result">    > flawfinder: ([2] (buffer) memcpy) Does not check for buffer overflows when copying to destination (CWE-120).  Make sure destination can always hold the source data.</span>
582 	    <span class="n">free</span><span class="p">(</span><span class="n">ptr1</span><span class="p">);</span>
583 	<span class="p">}</span>
584 <span class="p">}</span>
585 
586 <span class="cm">/* Types of defects: heap underrun(dynamic buffer underrun)</span>
587 <span class="cm">* Complexity: ---- underrun when using a structure</span>
588 <span class="cm">*/</span>
589 
590 
591 <span class="k">typedef</span> <span class="k">struct</span>
592 <span class="p">{</span>
593 	<span class="kt">char</span> <span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="result">    > flawfinder: ([2] (buffer) char) Statically-sized arrays can be improperly restricted, leading to potential overflows or other issues (CWE-119!/CWE-120).  Perform bounds checking, use functions that limit length, or ensure that the size is larger than the maximum possible length.</span>
594 	<span class="kt">int</span> <span class="n">arri</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
595 <span class="p">}</span><span class="n">dynamic_buffer_underrun_s_032</span><span class="p">;</span>
596 
597 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_032</span><span class="p">()</span>
598 <span class="p">{</span>
599 	<span class="n">dynamic_buffer_underrun_s_032</span><span class="o">*</span> <span class="n">ptr_s</span><span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_s_032</span><span class="p">));</span>
600 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
601 
602 	<span class="k">if</span><span class="p">(</span><span class="n">ptr_s</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
603 	<span class="p">{</span>
604 		<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
605 	    <span class="n">ptr_s</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
606 		<span class="n">free</span><span class="p">(</span><span class="n">ptr_s</span><span class="p">);</span>
607 	<span class="p">}</span>
608 <span class="p">}</span>
609 
610 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_033</span><span class="p">()</span>
611 <span class="p">{</span>
612 	<span class="kt">char</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
613 	<span class="kt">int</span> <span class="n">index</span><span class="o">=</span><span class="mi">12</span><span class="p">;</span>
614 	<span class="kt">int</span> <span class="n">len</span><span class="o">=</span><span class="n">index</span><span class="o">-</span><span class="mi">12</span><span class="p">;</span>
615 	<span class="kt">int</span> <span class="n">c</span><span class="p">;</span>
616     <span class="k">if</span><span class="p">(</span><span class="n">message</span> <span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
617     <span class="p">{</span>
618 	    <span class="k">while</span><span class="p">(</span><span class="n">len</span><span class="o">&gt;=-</span><span class="mi">2</span> <span class="p">)</span>
619 	    <span class="p">{</span>
620 		   <span class="n">c</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="n">len</span><span class="p">];</span>
621 		   <span class="k">if</span><span class="p">(</span><span class="n">isspace</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
622 		   <span class="p">{</span>
623 			   <span class="n">message</span><span class="p">[</span><span class="n">len</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;\n&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
624 		   <span class="p">}</span>
625 
626 	    <span class="n">len</span><span class="o">--</span><span class="p">;</span>
627         <span class="p">}</span>
628 		<span class="n">free</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
629 	<span class="p">}</span>
630 <span class="p">}</span>
631 
632 <span class="cm">/*</span>
633 <span class="cm">* Types of defects: Buffer underrun</span>
634 <span class="cm">* Complexity: Buffer Underrun when using strings</span>
635 <span class="cm">*/</span>
636 
637 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_034</span><span class="p">()</span>
638 <span class="p">{</span>
639 	<span class="kt">char</span><span class="o">*</span> <span class="n">srcbuf</span><span class="o">=</span><span class="s">&quot;Test Code&quot;</span><span class="p">;</span>
640 	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
641 	<span class="kt">char</span><span class="o">*</span> <span class="n">destbuf</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
642 	<span class="kt">char</span> <span class="n">ch</span><span class="o">=</span><span class="sc">&#39;o&#39;</span><span class="p">;</span>
643 	<span class="k">if</span><span class="p">(</span><span class="n">destbuf</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
644 	<span class="p">{</span>
645 		<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
646 	    <span class="p">{</span>
647 		     <span class="k">if</span><span class="p">(</span><span class="n">srcbuf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="n">ch</span><span class="p">)</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
<span class="result">    > scan-build: (Logic error core.UndefinedBinaryOperatorResult) The left operand of '==' is a garbage value due to array index out of bounds</span>
648 		     <span class="p">{</span>
649 			     <span class="n">loc</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
650 		     <span class="p">}</span>
651 	    <span class="p">}</span>
652 	    <span class="n">strncpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">destbuf</span><span class="p">[</span><span class="n">loc</span><span class="p">],</span><span class="o">&amp;</span><span class="n">srcbuf</span><span class="p">[</span><span class="n">loc</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
<span class="result">    > flawfinder: ([1] (buffer) strncpy) Easily used incorrectly; doesn't always \0-terminate or check for invalid pointers [MS-banned] (CWE-120).</span>
653 	    <span class="n">free</span><span class="p">(</span><span class="n">destbuf</span><span class="p">);</span>
654 	<span class="p">}</span>
655 <span class="p">}</span>
656 
657 <span class="cm">/*</span>
658 <span class="cm">* Types of defects: Buffer underrun</span>
659 <span class="cm">* Complexity: Buffer Underrun when using double pointers</span>
660 <span class="cm">*/</span>
661 
662 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_035</span><span class="p">()</span>
663 <span class="p">{</span>
664 	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">loc1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">loc2</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
665 	<span class="kt">char</span><span class="o">**</span> <span class="n">doubleptr</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">**</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">));</span>
666 	
667 	<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
668 	<span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
<span class="result">    > infer: (HIGH Null Dereference) pointer `doubleptr` last assigned on line 665 could be null and is dereferenced at line 668, column 2.</span>
669 	
670 	<span class="k">if</span> <span class="p">(</span><span class="n">loc1</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
671 	<span class="n">loc1</span><span class="o">--</span><span class="p">;</span>
672 
673 	<span class="n">doubleptr</span><span class="p">[</span><span class="n">loc1</span><span class="p">][</span><span class="n">loc2</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;T&#39;</span><span class="p">;</span>	
<span class="result">    > infer: (HIGH Buffer Overrun L1) Offset: [-1, -1] Size: [10, 10].</span>
674 	
675 	<span class="k">if</span><span class="p">(</span><span class="n">loc2</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
676 	<span class="n">loc2</span><span class="o">--</span><span class="p">;</span>
677 
678 	<span class="n">doubleptr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">loc2</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;T&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
679 	<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
680 	<span class="p">{</span>
681 		<span class="n">free</span><span class="p">(</span><span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
682 	<span class="p">}</span>
683 	<span class="n">free</span><span class="p">(</span><span class="n">doubleptr</span><span class="p">);</span>
684 <span class="p">}</span>
685 
686 
687 <span class="cm">/*</span>
688 <span class="cm">* Types of defects: Buffer underrun </span>
689 <span class="cm">* Complexity: Buffer Underrun when doing a short read using memcpy</span>
690 <span class="cm">*/</span>
691 
692 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_036</span><span class="p">()</span>
693 <span class="p">{</span>
694 	  <span class="kt">char</span> <span class="n">test</span><span class="p">[]</span><span class="o">=</span><span class="s">&quot;This is a test code&quot;</span><span class="p">;</span>
695 	  <span class="kt">char</span> <span class="o">*</span><span class="n">newTest</span><span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
696 	  <span class="k">if</span><span class="p">(</span><span class="n">newTest</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
697 	  <span class="p">{</span>
698 	     <span class="n">memcpy</span> <span class="p">(</span><span class="n">newTest</span><span class="p">,</span><span class="n">test</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span>
<span class="result">    > flawfinder: ([2] (buffer) memcpy) Does not check for buffer overflows when copying to destination (CWE-120).  Make sure destination can always hold the source data.</span>
699 	     <span class="kt">char</span> <span class="n">c</span> <span class="p">;</span>
700 	     <span class="n">c</span> <span class="o">=</span> <span class="n">newTest</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">];</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
<span class="result">    > cppcheck: (error arrayIndexOutOfBounds) Array 'newTest[10]' accessed at index -10, which is out of bounds.</span>
<span class="result">    > scan-build: (Dead store deadcode.DeadStores) Value stored to 'c' is never read</span>
<span class="result">    > infer: (HIGH Buffer Overrun L1) Offset: [-10, -10] Size: [10, 10].</span>
<span class="result">    > infer: (HIGH Dead Store) The value written to &c is never used.</span>
701 	     <span class="n">free</span><span class="p">(</span><span class="n">newTest</span><span class="p">);</span>
702 	  <span class="p">}</span>
703  <span class="p">}</span>
704 
705 
706 <span class="cm">/*</span>
707 <span class="cm">* Types of defects: Buffer underrun </span>
708 <span class="cm">* Complexity: Buffer Underrun when doing a short read</span>
709 <span class="cm">*/</span>
710 
711 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_037</span><span class="p">()</span>
712 <span class="p">{</span>
713 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
714 	<span class="kt">char</span><span class="o">**</span> <span class="n">doubleptr</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">**</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">));</span>
715 	
716 	<span class="k">if</span><span class="p">(</span><span class="n">doubleptr</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
717 	<span class="p">{</span>
718 	    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
719 	    <span class="p">{</span>
720 	    	<span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
<span class="result">    > infer: (HIGH Buffer Overrun L1) Offset: [-10, -1] Size: [10, 10].</span>
721 	    	<span class="k">if</span><span class="p">(</span><span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
<span class="result">    > scan-build: (Logic error core.UndefinedBinaryOperatorResult) The left operand of '!=' is a garbage value</span>
722 	    	<span class="p">{</span>
723 	    	    <span class="n">doubleptr</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;T&#39;</span><span class="p">;</span>
724 			    <span class="n">free</span><span class="p">(</span><span class="n">doubleptr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
725 	    	<span class="p">}</span>
726 	    <span class="p">}</span>
727 		<span class="n">free</span><span class="p">(</span><span class="n">doubleptr</span><span class="p">);</span>
728 	<span class="p">}</span>
729 <span class="p">}</span>
730 
731 <span class="cm">/*</span>
732 <span class="cm">* Types of defects: Buffer underrun </span>
733 <span class="cm">* Complexity: Buffer Underrun when using structures</span>
734 <span class="cm">*/</span>
735 
736 <span class="k">typedef</span> <span class="k">struct</span>
737 <span class="p">{</span>
738 	<span class="kt">char</span> <span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="result">    > flawfinder: ([2] (buffer) char) Statically-sized arrays can be improperly restricted, leading to potential overflows or other issues (CWE-119!/CWE-120).  Perform bounds checking, use functions that limit length, or ensure that the size is larger than the maximum possible length.</span>
739 	<span class="kt">int</span> <span class="n">arri</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
740 
741 <span class="p">}</span><span class="n">dynamic_buffer_underrun_s_038</span><span class="p">;</span>
742 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_038</span><span class="p">()</span>
743 <span class="p">{</span>
744 	<span class="n">dynamic_buffer_underrun_s_038</span><span class="o">*</span> <span class="n">new_s</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_s_038</span><span class="p">));</span>
745 <span class="cm">/*	dynamic_buffer_underrun_s_007* ptr_s=malloc(10*sizeof(dynamic_buffer_underrun_s_007));*/</span>
746 	<span class="kt">int</span> <span class="n">loc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
747 
748 	<span class="k">if</span><span class="p">(</span><span class="n">new_s</span><span class="o">!=</span><span class="nb">NULL</span><span class="p">)</span>
749 	<span class="p">{</span>
750 		<span class="n">new_s</span><span class="p">[</span><span class="n">loc</span><span class="p">].</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="sc">&#39;a&#39;</span><span class="p">;</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
751 	    <span class="n">new_s</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">arri</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
752 	    <span class="n">free</span><span class="p">(</span><span class="n">new_s</span><span class="p">);</span>
753 	<span class="p">}</span>
754 <span class="p">}</span>
755 
756 <span class="cm">/*</span>
757 <span class="cm">* Types of defects: Buffer underrun </span>
758 <span class="cm">* Complexity: Buffer Underrun when using memcpy to copy structures</span>
759 <span class="cm">*/</span>
760 <span class="k">typedef</span> <span class="k">struct</span>
761 <span class="p">{</span>
762 	<span class="kt">char</span> <span class="n">arr</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="result">    > flawfinder: ([2] (buffer) char) Statically-sized arrays can be improperly restricted, leading to potential overflows or other issues (CWE-119!/CWE-120).  Perform bounds checking, use functions that limit length, or ensure that the size is larger than the maximum possible length.</span>
763 	<span class="kt">int</span> <span class="n">arri</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
764 
765 <span class="p">}</span><span class="n">dynamic_buffer_underrun_s_008</span><span class="p">;</span>
766 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_039</span><span class="p">()</span>
767 <span class="p">{</span>
768 	<span class="cm">/*dynamic_buffer_underrun_s_008* new_s;*/</span>
769 	<span class="n">dynamic_buffer_underrun_s_008</span><span class="o">*</span> <span class="n">ptr_s1</span><span class="o">=</span><span class="n">malloc</span><span class="p">(</span><span class="mi">15</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_s_008</span><span class="p">));</span>
770 	<span class="n">dynamic_buffer_underrun_s_008</span>  <span class="n">ptr_s2</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
771 	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
772 
773 	<span class="k">if</span><span class="p">(</span><span class="n">ptr_s1</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
774 	<span class="p">{</span>
775 		<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=-</span><span class="mi">10</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
776 		<span class="p">{</span>
777 			<span class="n">memset</span><span class="p">(</span><span class="n">ptr_s1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_s_008</span><span class="p">));</span> <span class="cm">/*Tool should detect this line as error*/</span> <span class="cm">/*ERROR:Buffer Underrun*/</span>
778 		<span class="p">}</span>
779 	    <span class="n">memcpy</span><span class="p">(</span><span class="n">ptr_s2</span><span class="p">,</span><span class="n">ptr_s1</span><span class="p">,</span><span class="mi">15</span><span class="o">*</span><span class="k">sizeof</span><span class="p">(</span><span class="n">dynamic_buffer_underrun_s_008</span><span class="p">));</span>
<span class="result">    > flawfinder: ([2] (buffer) memcpy) Does not check for buffer overflows when copying to destination (CWE-120).  Make sure destination can always hold the source data.</span>
780 	    <span class="n">free</span><span class="p">(</span><span class="n">ptr_s1</span><span class="p">);</span>
781 	<span class="p">}</span>
782 <span class="p">}</span>
783 
784 
785 <span class="cm">/*</span>
786 <span class="cm">* Types of defects: Buffer underrun</span>
787 <span class="cm">* Buffer Underrun main function</span>
788 <span class="cm">*/</span>
789 <span class="k">extern</span> <span class="k">volatile</span> <span class="kt">int</span> <span class="n">vflag</span><span class="p">;</span>
790 <span class="kt">void</span> <span class="nf">dynamic_buffer_underrun_main</span> <span class="p">()</span>
791 <span class="p">{</span>
792 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
793 	<span class="p">{</span>
794 		<span class="n">dynamic_buffer_underrun_001</span><span class="p">();</span>
795 	<span class="p">}</span>
796 
797 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
798 	<span class="p">{</span>
799 		<span class="n">dynamic_buffer_underrun_002</span><span class="p">();</span>
800 	<span class="p">}</span>
801 
802 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">3</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
803 	<span class="p">{</span>
804 		<span class="n">dynamic_buffer_underrun_003</span><span class="p">();</span>
805 	<span class="p">}</span>
806 
807 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
808 	<span class="p">{</span>
809 		<span class="n">dynamic_buffer_underrun_004</span><span class="p">();</span>
810 	<span class="p">}</span>
811 
812 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">5</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
813 	<span class="p">{</span>
814 		<span class="n">dynamic_buffer_underrun_005</span><span class="p">();</span>
815 	<span class="p">}</span>
816 
817 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">6</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
818 	<span class="p">{</span>
819 		<span class="n">dynamic_buffer_underrun_006</span><span class="p">();</span>
820 	<span class="p">}</span>
821 
822 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">7</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
823 	<span class="p">{</span>
824 		<span class="n">dynamic_buffer_underrun_007</span><span class="p">();</span>
825 	<span class="p">}</span>
826 
827 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">8</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
828 	<span class="p">{</span>
829 		<span class="n">dynamic_buffer_underrun_008</span><span class="p">();</span>
830 	<span class="p">}</span>
831 
832 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">9</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
833 	<span class="p">{</span>
834 		<span class="n">dynamic_buffer_underrun_009</span><span class="p">();</span>
835 	<span class="p">}</span>
836 
837 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">10</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
838 	<span class="p">{</span>
839 		<span class="n">dynamic_buffer_underrun_010</span><span class="p">();</span>
840 	<span class="p">}</span>
841 
842 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">11</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
843 	<span class="p">{</span>
844 		<span class="n">dynamic_buffer_underrun_011</span><span class="p">();</span>
845 	<span class="p">}</span>
846 
847 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">12</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
848 	<span class="p">{</span>
849 		<span class="n">dynamic_buffer_underrun_012</span><span class="p">();</span>
850 	<span class="p">}</span>
851 
852 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">13</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
853 	<span class="p">{</span>
854 		<span class="n">dynamic_buffer_underrun_013</span><span class="p">();</span>
855 	<span class="p">}</span>
856 
857 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">14</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
858 	<span class="p">{</span>
859 		<span class="n">dynamic_buffer_underrun_014</span><span class="p">();</span>
860 	<span class="p">}</span>
861 
862 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">15</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
863 	<span class="p">{</span>
864 		<span class="n">dynamic_buffer_underrun_015</span><span class="p">();</span>
865 	<span class="p">}</span>
866 
867 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">16</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
868 	<span class="p">{</span>
869 		<span class="n">dynamic_buffer_underrun_016</span><span class="p">();</span>
870 	<span class="p">}</span>
871 
872 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">17</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
873 	<span class="p">{</span>
874 		<span class="n">dynamic_buffer_underrun_017</span><span class="p">();</span>
875 	<span class="p">}</span>
876 
877 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">18</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
878 	<span class="p">{</span>
879 		<span class="n">dynamic_buffer_underrun_018</span><span class="p">();</span>
880 	<span class="p">}</span>
881 
882 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">19</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
883 	<span class="p">{</span>
884 		<span class="n">dynamic_buffer_underrun_019</span><span class="p">();</span>
885 	<span class="p">}</span>
886 
887 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">20</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
888 	<span class="p">{</span>
889 		<span class="n">dynamic_buffer_underrun_020</span><span class="p">();</span>
890 	<span class="p">}</span>
891 
892 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">21</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
893 	<span class="p">{</span>
894 		<span class="n">dynamic_buffer_underrun_021</span><span class="p">();</span>
895 	<span class="p">}</span>
896 
897 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">22</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
898 	<span class="p">{</span>
899 		<span class="n">dynamic_buffer_underrun_022</span><span class="p">();</span>
900 	<span class="p">}</span>
901 
902 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">23</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
903 	<span class="p">{</span>
904 		<span class="n">dynamic_buffer_underrun_023</span><span class="p">();</span>
905 	<span class="p">}</span>
906 
907 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">24</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
908 	<span class="p">{</span>
909 		<span class="n">dynamic_buffer_underrun_024</span><span class="p">();</span>
910 	<span class="p">}</span>
911 
912 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">25</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
913 	<span class="p">{</span>
914 		<span class="n">dynamic_buffer_underrun_025</span><span class="p">();</span>
915 	<span class="p">}</span>
916 
917 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">26</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
918 	<span class="p">{</span>
919 		<span class="n">dynamic_buffer_underrun_026</span><span class="p">();</span>
920 	<span class="p">}</span>
921 
922 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">27</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
923 	<span class="p">{</span>
924 		<span class="n">dynamic_buffer_underrun_027</span><span class="p">();</span>
925 	<span class="p">}</span>
926 
927 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">28</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
928 	<span class="p">{</span>
929 		<span class="n">dynamic_buffer_underrun_028</span><span class="p">();</span>
930 	<span class="p">}</span>
931 
932 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">29</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
933 	<span class="p">{</span>
934 		<span class="n">dynamic_buffer_underrun_029</span><span class="p">();</span>
935 	<span class="p">}</span>
936 
937 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">30</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
938 	<span class="p">{</span>
939 		<span class="n">dynamic_buffer_underrun_030</span><span class="p">();</span>
940 	<span class="p">}</span>
941 
942 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">31</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
943 	<span class="p">{</span>
944 		<span class="n">dynamic_buffer_underrun_031</span><span class="p">();</span>
945 	<span class="p">}</span>
946 
947 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">32</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
948 	<span class="p">{</span>
949 		<span class="n">dynamic_buffer_underrun_032</span><span class="p">();</span>
950 	<span class="p">}</span>
951 
952 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">33</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
953 	<span class="p">{</span>
954 		<span class="n">dynamic_buffer_underrun_033</span><span class="p">();</span>
955 	<span class="p">}</span>
956 
957 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">34</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
958 	<span class="p">{</span>
959 		<span class="n">dynamic_buffer_underrun_034</span><span class="p">();</span>
960 	<span class="p">}</span>
961 
962 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">35</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
963 	<span class="p">{</span>
964 		<span class="n">dynamic_buffer_underrun_035</span><span class="p">();</span>
965 	<span class="p">}</span>
966 
967 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">36</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
968 	<span class="p">{</span>
969 		<span class="n">dynamic_buffer_underrun_036</span><span class="p">();</span>
970 	<span class="p">}</span>
971 
972 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">37</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
973 	<span class="p">{</span>
974 		<span class="n">dynamic_buffer_underrun_037</span><span class="p">();</span>
975 	<span class="p">}</span>
976 
977 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">38</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
978 	<span class="p">{</span>
979 		<span class="n">dynamic_buffer_underrun_038</span><span class="p">();</span>
980 	<span class="p">}</span>
981 
982 	<span class="k">if</span> <span class="p">(</span><span class="n">vflag</span> <span class="o">==</span> <span class="mi">39</span> <span class="o">||</span> <span class="n">vflag</span> <span class="o">==</span><span class="mi">888</span><span class="p">)</span>
983 	<span class="p">{</span>
984 		<span class="n">dynamic_buffer_underrun_039</span><span class="p">();</span>
985 	<span class="p">}</span>
986 
987 <span class="p">}</span>
988 
</pre></div>
</body>
</html>
